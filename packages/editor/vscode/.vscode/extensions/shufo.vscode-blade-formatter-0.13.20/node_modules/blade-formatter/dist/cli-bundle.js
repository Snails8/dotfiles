var je=Object.create;var A=Object.defineProperty;var ze=Object.getOwnPropertyDescriptor;var Oe=Object.getOwnPropertyNames;var We=Object.getPrototypeOf,Ne=Object.prototype.hasOwnProperty;var Y=o=>A(o,"__esModule",{value:!0});var Je=(o,e)=>{for(var t in e)A(o,t,{get:e[t],enumerable:!0})},Z=(o,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of Oe(e))!Ne.call(o,r)&&(t||r!=="default")&&A(o,r,{get:()=>e[r],enumerable:!(n=ze(e,r))||n.enumerable});return o},d=(o,e)=>Z(Y(A(o!=null?je(We(o)):{},"default",!e&&o&&o.__esModule?{get:()=>o.default,enumerable:!0}:{value:o,enumerable:!0})),o),Xe=(o=>(e,t)=>o&&o.get(e)||(t=Z(Y({}),e,1),o&&o.set(e,t),t))(typeof WeakMap!="undefined"?new WeakMap:0);var qe={};Je(qe,{default:()=>De});var Ee=d(require("yargs")),Fe=d(require("concat-stream")),ke=require("vscode-oniguruma"),Te=require("fs"),Ae=require("yargs/helpers");var Ie=d(require("ignore")),k=d(require("path")),I=d(require("fs")),u=d(require("process")),w=d(require("chalk")),Re=d(require("glob")),Q=d(require("util")),f=d(require("lodash")),Le=d(require("find-config"));var _e=d(require("os")),x=d(require("js-beautify")),i=d(require("lodash")),Ue=d(require("vscode-textmate")),B=d(require("detect-indent")),we=d(require("aigle")),q=d(require("xregexp")),$e=require("@shufo/tailwindcss-class-sorter");var ge=require("fs"),ye=d(require("lodash")),U=d(require("vscode-oniguruma")),fe=d(require("path"));var $=d(require("lodash")),ae=d(require("fs")),N=d(require("chalk")),J=d(require("prettier/standalone")),X=d(require("@prettier/plugin-php/standalone")),He=d(require("detect-indent"));var L=d(require("lodash")),M="@",v=["@alert","@push","@slot","@switch","@unless","@verbatim","@prepend","@once","@error","@empty","@guest","@isset","@permission","@permissions","@canany","@cannot","@can","@role","@hasrole","@hasanyrole","@hasallroles","@unlessrole","@hasexactroles","@if","@production","@env","@while","@auth","@forelse","@for","@foreach","@php","@component","@hassection","@section"],ee=L.default.map(v,o=>o.substring(1)),D=["@endalert","@endpush","@endslot","@endswitch","@endunless","@endverbatim","@show","@stop","@endprepend","@endonce","@enderror","@append","@overwrite","@endempty","@endguest","@endisset","@endpermission","@endpermissions","@endcanany","@endcannot","@endcan","@endrole","@endhasrole","@endhasanyrole","@endhasallroles","@endunlessrole","@endhasexactroles","@endif","@endproduction","@endenv","@endwhile","@endauth","@endforelse","@endforeach","@endfor","@endphp","@endcomponent","@endsection"],j=["@elseenv","@elseif","@elsecanany","@elsecannot","@elsecan","@else"],V={"@section":2,"@push":2,"@prepend":2,"@slot":2},te=["@forelse"],ne=["@empty"],re=["@default"],z=["@forelse","@if","@for","@foreach","@while","@sectionmissing","@case"],O=["@endforelse","@endif","@endforeach","@endfor","@endwhile","@break"],W=["@json","@selected","@checked","@disabled","@php","@include","@includeif","@includewhen","@includeunless","@includefirst","@button","@class"],ie=["@if","@while","@case","@isset","@empty","@elseif"];function se(o,e){return L.default.filter(o.tokens,t=>{let n=e.substring(t.startIndex,t.endIndex).trim();return L.default.includes(v,n)||L.default.includes(D,n)}).length>=2}var b="\\(((?:[^)(]+|\\((?:[^)(]+|\\((?:[^)(]+|\\((?:[^)(]+|\\([^)(]*\\))*\\))*\\))*\\))*)\\)";var _=o=>{let e={get(){return null}};return $.default.isUndefined(o)||$.default.isNull(o)?e:o};async function H(o){return new Promise((e,t)=>{ae.default.readFile(o,(n,r)=>n?t(n):e(r))})}function E(o){return o?o.split(/\r\n|\n|\r/):""}function S(o){return J.default.format(o.replace(/\n$/,""),{parser:"php",printWidth:1e3,singleQuote:!0,phpVersion:"8.0",plugins:[X.default]})}function P(o,e=1e3,t=!0){return J.default.format(`<?php echo ${o} ?>`,{parser:"php",printWidth:e,singleQuote:!0,phpVersion:"8.0",trailingCommaPHP:t,plugins:[X.default]}).replace(/<\?php echo (.*)?\?>/gs,(n,r)=>r.trim().replace(/;\s*$/,""))}function oe(o){let e=`<?php tmp_func${o}; ?>`,{ast:t}=J.default.__debug.parse(e,{parser:"php",phpVersion:"8.0",plugins:[X.default]});try{return t.children[0].expression.arguments.length||0}catch{return 0}}function le(o){return Promise.all($.default.map(o,async e=>{process.stdout.write(`path: ${N.default.bold(e.path)}:${e.line}
`),process.stdout.write(N.default.red(`--${e.original}
`)),process.stdout.write(N.default.green(`++${e.formatted}
`))}))}function he(o,e,t){let n=$.default.map(e,(r,s)=>$.default.isEmpty(r)||r===t[s]?null:{path:o,line:s+1,original:r,formatted:t[s]});return $.default.without(n,null)}async function Ke(o){let e=$.default.without(v,"@switch","@forelse","@php").join("|"),t=new RegExp(`(?!\\/\\*.*?\\*\\/)(${e})(\\s*?)${b}`,"gmi");return new Promise(n=>n(o)).then(n=>$.default.replace(n,t,(r,s,a,l)=>S(`<?php ${s.substr("1")}${a}(${l}) ?>`).replace(/<\?php\s(.*?)(\s*?)\((.*?)\);*\s\?>\n/gs,(h,c,m,p)=>`@${c.trim()}${m}(${p.trim()})`).replace(/([\n\s]*)->([\n\s]*)/gs,"->"))).then(n=>S(n))}async function ce(o){return Ke(o)}function pe(o){let e=$.default.without(z,"@case"),t=$.default.without(O,"@break");return new Promise(n=>n(o)).then(n=>{let r=new RegExp(`(${e.join("|")})([\\s]*?)${b}`,"gis");return $.default.replace(n,r,(s,a,l,h)=>`<beautifyTag start="${a}${l}" exp="^^^${$.default.escape(h)}^^^">`)}).then(n=>{let r=new RegExp(`(?!end=".*)(${t.join("|")})(?!.*")`,"gi");return $.default.replace(n,r,(s,a)=>`</beautifyTag end="${a}">`)})}function de(o){return new Promise(e=>e(o)).then(e=>$.default.replace(e,/<beautifyTag.*?start="(.*?)".*?exp=".*?\^\^\^(.*?)\^\^\^.*?"\s*>/gs,(t,n,r)=>`${n}(${$.default.unescape(r)})`)).then(e=>$.default.replace(e,/<\/beautifyTag.*?end="(.*?)"\s*>/gs,(t,n)=>`${n}`))}var Me=["/\\*\\* phptag_start \\*\\*/","/\\*\\* end_phptag \\*\\*/","/\\*escaped\\*/","__BLADE__;","/\\* blade_comment_start \\*/","/\\* blade_comment_end \\*/","beautifyTag"];function ue(o){if(new RegExp(Me.join("|")).test(o))throw new Error(["Can't format blade: something goes wrong.","Please check if template is too complicated or not. Or simplify template might solves issue."].join(`
`));return o}var G=class{constructor(e,t){return(async()=>{var n;return this.vsctm=(n=e.default)!=null?n:e,this.oniguruma=t||U.default||U,await this.loadWasm(),this})()}async loadWasm(){var t;let e=await ge.promises.readFile(require.resolve("vscode-oniguruma/release/onig.wasm"));if(await((t=this.oniguruma)==null?void 0:t.loadWASM(e.buffer)),!this.initCalled){try{this.oniguruma.loadWASM(e.buffer)}catch{this.initCalled=!0}this.initCalled=!0}}createRegistry(){return this.registry=new this.vsctm.Registry({loadGrammar:e=>e==="text.html.php.blade"?H(fe.default.resolve(__dirname,"../syntaxes/blade.tmLanguage.json")).then(t=>this.vsctm.parseRawGrammar(t.toString(),"./blade.tmLanguage.json")):null,onigLib:Promise.resolve({createOnigScanner:e=>new this.oniguruma.OnigScanner(e),createOnigString:e=>new this.oniguruma.OnigString(e)})}),this.registry}tokenizeLines(e,t){return ye.default.map(e,n=>{var r;return t.tokenizeLine(n,(r=this.vsctm)==null?void 0:r.INITIAL)})}};var F=class{constructor(e){this.options=e,this.vsctm=_(this.options).vsctm||Ue,this.oniguruma=_(this.options).oniguruma,this.indentCharacter=_(this.options).useTabs?"	":" ",this.indentSize=_(this.options).indentSize||4,this.wrapLineLength=_(this.options).wrapLineLength||120,this.wrapAttributes=_(this.options).wrapAttributes||"auto",this.currentIndentLevel=0,this.shouldBeIndent=!1,this.isInsideCommentBlock=!1,this.stack=[],this.ignoredLines=[],this.curlyBracesWithJSs=[],this.rawBlocks=[],this.rawPhpTags=[],this.inlineDirectives=[],this.conditions=[],this.inlinePhpDirectives=[],this.rawPropsBlocks=[],this.bladeDirectives=[],this.bladeComments=[],this.bladeBraces=[],this.rawBladeBraces=[],this.scripts=[],this.classes=[],this.xData=[],this.xInit=[],this.htmlTags=[],this.templatingStrings=[],this.stringLiteralInPhp=[],this.shorthandBindings=[],this.componentAttributes=[],this.result=[],this.diffs=[]}formatContent(e){return new Promise(t=>t(e)).then(t=>this.preserveIgnoredLines(t)).then(t=>this.preserveCurlyBraceForJS(t)).then(t=>this.preserveRawPhpTags(t)).then(t=>ce(t)).then(t=>this.preserveBladeComment(t)).then(t=>this.preserveBladeBrace(t)).then(t=>this.preserveRawBladeBrace(t)).then(t=>this.preserveConditions(t)).then(t=>this.preserveInlineDirective(t)).then(t=>this.preserveInlinePhpDirective(t)).then(t=>this.breakLineBeforeAndAfterDirective(t)).then(t=>this.preserveBladeDirectivesInScripts(t)).then(async t=>(this.bladeDirectives=await this.formatPreservedBladeDirectives(this.bladeDirectives),t)).then(t=>this.preserveScripts(t)).then(t=>this.sortTailwindcssClasses(t)).then(t=>this.preserveComponentAttribute(t)).then(t=>this.preserveShorthandBinding(t)).then(t=>this.preserveClass(t)).then(t=>this.formatXData(t)).then(t=>this.formatXInit(t)).then(t=>this.preserveHtmlTags(t)).then(t=>this.formatAsHtml(t)).then(t=>this.formatAsBlade(t)).then(t=>this.restoreHtmlTags(t)).then(t=>this.restoreClass(t)).then(t=>this.restoreShorthandBinding(t)).then(t=>this.restoreComponentAttribute(t)).then(t=>this.restoreXData(t)).then(t=>this.restoreXInit(t)).then(t=>this.restoreScripts(t)).then(t=>this.restoreBladeDirectivesInScripts(t)).then(t=>this.restoreInlinePhpDirective(t)).then(t=>this.restoreInlineDirective(t)).then(t=>this.restoreConditions(t)).then(t=>this.restoreRawBladeBrace(t)).then(t=>this.restoreBladeBrace(t)).then(t=>this.restoreBladeComment(t)).then(t=>this.restoreRawPhpTags(t)).then(t=>this.restoreCurlyBraceForJS(t)).then(t=>this.restoreIgnoredLines(t)).then(t=>ue(t))}formatAsHtml(e){let t={indent_size:_(this.options).indentSize||4,wrap_line_length:_(this.options).wrapLineLength||120,wrap_attributes:_(this.options).wrapAttributes||"auto",end_with_newline:_(this.options).endWithNewline||!0},n=new Promise(r=>r(e)).then(r=>this.preservePhpBlock(r)).then(r=>pe(r)).then(r=>x.default.html_beautify(r,t)).then(r=>de(r)).then(r=>this.restorePhpBlock(r));return Promise.resolve(n)}async sortTailwindcssClasses(e){return this.options.sortTailwindcssClasses?i.default.replace(e,/\bclass\s*=\s*([\"\'])(.+?)([\"\'])/gis,(t,n,r,s)=>`class=${n}${(0,$e.sortClasses)(r)}${s}`):e}async preserveIgnoredLines(e){return i.default.chain(e).replace(/(^(?<!.+)^{{--\s*blade-formatter-disable\s*--}}.*?)([\r\n]*)$(?![\r\n])/gis,(t,n,r)=>this.storeIgnoredLines(`${n}${r.replace(/^\n/,"")}`)).replace(/{{--\s*?blade-formatter-disable\s*?--}}.*?{{--\s*?blade-formatter-enable\s*?--}}/gis,t=>this.storeIgnoredLines(t)).replace(/{{--\s*?blade-formatter-disable-next-line\s*?--}}[\r\n]+[^\r\n]+/gis,t=>this.storeIgnoredLines(t)).value()}async preserveCurlyBraceForJS(e){return i.default.replace(e,/@{{(.*?)}}/gs,(t,n)=>this.storeCurlyBraceForJS(n))}async preservePhpBlock(e){return this.preserveRawPhpBlock(e).then(t=>this.preservePropsBlock(t))}async preservePropsBlock(e){return i.default.replace(e,/@props\(((?:[^\\(\\)]|\([^\\(\\)]*\))*)\)/gs,(t,n)=>this.storeRawPropsBlock(n))}async preserveRawPhpBlock(e){return i.default.replace(e,/(?<!@)@php(.*?)@endphp/gs,(t,n)=>this.storeRawBlock(n))}async preserveHtmlTags(e){let t=["textarea","pre"];return i.default.replace(e,new RegExp(`<(${t.join("|")})\\s{0,1}.*?>.*?<\\/(${t.join("|")})>`,"gis"),n=>this.storeHtmlTag(n))}preserveInlineDirective(e){let t=new RegExp(`(<[\\w]+?[^>]*?)${M}(${ee.join("|")})(\\s*?)(${b})(.*?)(@end\\2)(.*?>)`,"gims"),n=i.default.replace(e,t,(r,s,a,l,h,c,m,p,g)=>`${s}${this.storeInlineDirective(`${M}${a.trim()}${l}${h.trim()} ${m.trim()} ${p.trim()}`)}${g}`);return t.test(n)?this.preserveInlineDirective(n):n}async preserveInlinePhpDirective(e){return i.default.replace(e,new RegExp(`(?!\\/\\*.*?\\*\\/)(${W.join("|")})(\\s*?)${b}`,"gmsi"),t=>this.storeInlinePhpDirective(t))}preserveBladeDirectivesInScripts(e){return i.default.replace(e,/<script(.*?)>(.*?)<\/script>/gis,(t,n,r)=>{let s=[...v,...W];if(new RegExp(s.join("|"),"gmi").test(r)===!1)return`<script${n}>${r}<\/script>`;let a=W.join("|"),l=new RegExp(`(?!\\/\\*.*?\\*\\/)(${a})(\\s*?)${b}`,"gmi");r=i.default.replace(r,l,c=>this.storeBladeDirective(P(c)));let h=i.default.chain(v).without("@switch","@forelse","@empty").map(c=>i.default.replace(c,/@/,"")).value();return i.default.forEach(h,c=>{try{let m=q.default.matchRecursive(r,`\\@${c}`,`\\@end${c}`,"gmi",{valueNames:[null,"left","match","right"]}),p="";if(i.default.isEmpty(m))return;i.default.forEach(m,g=>{p+=g.value,g.name==="right"&&(r.includes(p)&&(r=i.default.replace(r,p,this.storeBladeDirective(p))),p="")})}catch{throw new Error("directive in scripts parsing error")}}),`<script${n}>${r}<\/script>`})}breakLineBeforeAndAfterDirective(e){e=i.default.replace(e,new RegExp(`(?<=<.*?>)(${i.default.without(v,"@php").join("|")})(\\s*)${b}.*?(?=<.*?>)`,"gmis"),s=>`
${s.trim()}
`),e=i.default.replace(e,new RegExp(`(?<=<.*?>).*?(${i.default.without(D,"@endphp").join("|")})(?=<.*?>)`,"gmis"),s=>`
${s.trim()}
`);let t=["@case",...j];e=i.default.replace(e,new RegExp(`(\\s*?)(${t.join("|")})(\\s*?)${b}(\\s*)`,"gmi"),s=>`
${s.trim()}
`),e=i.default.replace(e,new RegExp(`\\s*?(?!(${i.default.without(j,"@else").join("|")}))@else\\s+`,"gim"),s=>`
${s.trim()}
`),e=i.default.replace(e,/@case\S*?\s*?@case/gim,s=>`${s.replace(`
`,"")}`);let n=["@break"];i.default.forEach(n,s=>{e=i.default.replace(e,new RegExp(`(\\s*?)${s}\\s*`,"gmi"),a=>`
${a.trim()}

`)}),i.default.forEach(["@default"],s=>{e=i.default.replace(e,new RegExp(`(\\s*?)${s}\\s*`,"gmi"),a=>`

${a.trim()}
`)});let r=i.default.chain(v).map(s=>i.default.replace(s,/@/,"")).value();return i.default.forEach(r,s=>{try{let a=q.default.matchRecursive(e,`\\@${s}`,`\\@end${s}`,"gmi",{valueNames:[null,"left","match","right"]});if(i.default.isEmpty(a))return;for(let l of a)if(l.name==="match"){new RegExp(v.join("|")).test(l.value)&&(e=i.default.replace(e,l.value,this.breakLineBeforeAndAfterDirective(l.value)));let h=new RegExp(`^(\\s*?)${b}(.*)`,"gmis"),c=i.default.replace(`${l.value}`,h,(m,p,g,y)=>y.trim()===""?`${p}(${g.trim()})
${y.trim()}`:`${p}(${g.trim()})
${y.trim()}
`);e=i.default.replace(e,l.value,c)}}catch{}}),e}async preserveBladeComment(e){return i.default.replace(e,/\{\{--(.*?)--\}\}/gs,(t,n)=>this.storeBladeComment(n))}async preserveBladeBrace(e){return i.default.replace(e,/\{\{(.*?)\}\}/gs,(t,n)=>this.storeBladeBrace(n,n.length))}async preserveRawBladeBrace(e){return i.default.replace(e,/\{!!(.*?)!!\}/gs,(t,n)=>this.storeRawBladeBrace(n))}async preserveConditions(e){let t=new RegExp(`(${ie.join("|")})(\\s*?)${b}`,"gi");return i.default.replace(e,t,(n,r,s,a)=>`${r}${s}(${this.storeConditions(a)})`)}async preserveRawPhpTags(e){return i.default.replace(e,/<\?php(.*?)\?>/gms,t=>this.storeRawPhpTags(t))}async preserveScripts(e){return i.default.replace(e,/<script.*?>.*?<\/script>/gis,t=>this.storeScripts(t))}async preserveClass(e){return i.default.replace(e,/(\s*)class="(.*?)"(\s*)/gs,(t,n,r,s)=>`${n}class="${this.storeClass(r)}"${s}`)}async preserveShorthandBinding(e){return i.default.replace(e,/(?<=<[^<]*?(\s|x-bind)):{1}(?<!=>)[\w\-_.]*?=(["'])(?!=>)[^]*?\2(?=[^>]*?\/*?>)/gim,t=>`${this.storeShorthandBinding(t)}`)}async preserveComponentAttribute(e){return i.default.replace(e,/(?<=<x-[^<]*?\s):{1,2}(?<!=>)[\w\-_.]*?=(["'])(?!=>)[^]*?\1(?=[^>]*?\/*?>)/gim,t=>`${this.storeComponentAttribute(t)}`)}async formatXData(e){return i.default.replace(e,/(\s*)x-data="(.*?)"(\s*)/gs,(t,n,r,s)=>`${n}x-data="${this.storeXData(r)}"${s}`)}async formatXInit(e){return i.default.replace(e,/(\s*)x-init="(.*?)"(\s*)/gs,(t,n,r,s)=>`${n}x-init="${this.storeXInit(r)}"${s}`)}preserveStringLiteralInPhp(e){return i.default.replace(e,/['"].*?['"]/gms,t=>`${this.storeStringLiteralInPhp(t)}`)}storeIgnoredLines(e){return this.getIgnoredLinePlaceholder(this.ignoredLines.push(e)-1)}storeCurlyBraceForJS(e){return this.getCurlyBraceForJSPlaceholder(this.curlyBracesWithJSs.push(e)-1)}storeRawBlock(e){return this.getRawPlaceholder(this.rawBlocks.push(e)-1)}storeInlineDirective(e){return this.getInlinePlaceholder(this.inlineDirectives.push(e)-1,e.length)}storeConditions(e){return this.getConditionPlaceholder(this.conditions.push(e)-1)}storeInlinePhpDirective(e){return this.getInlinePhpPlaceholder(this.inlinePhpDirectives.push(e)-1)}storeRawPropsBlock(e){return this.getRawPropsPlaceholder(this.rawPropsBlocks.push(e)-1)}storeBladeDirective(e){return this.getBladeDirectivePlaceholder(this.bladeDirectives.push(e)-1)}storeBladeComment(e){return this.getBladeCommentPlaceholder(this.bladeComments.push(e)-1)}storeHtmlTag(e){return this.getHtmlTagPlaceholder((this.htmlTags.push(e)-1).toString())}storeBladeBrace(e,t){let n=this.bladeBraces.push(e)-1,r="{{  }}";return this.getBladeBracePlaceholder(n,t+r.length)}storeRawBladeBrace(e){let t=this.rawBladeBraces.push(e)-1;return this.getRawBladeBracePlaceholder(t)}storeRawPhpTags(e){let t=this.rawPhpTags.push(e)-1;return this.getRawPhpTagPlaceholder(t)}storeScripts(e){let t=this.scripts.push(e)-1;return this.getScriptPlaceholder(t)}storeClass(e){let t=this.classes.push(e)-1;return e.length>0?this.getClassPlaceholder(t,e.length):this.getClassPlaceholder(t,null)}storeShorthandBinding(e){let t=this.shorthandBindings.push(e)-1;return this.getShorthandBindingPlaceholder(t.toString(),e.length)}storeComponentAttribute(e){let t=this.componentAttributes.push(e)-1;return this.getComponentAttributePlaceholder(t.toString())}storeXData(e){let t=this.xData.push(e)-1;return this.getXDataPlaceholder(t)}storeXInit(e){let t=this.xInit.push(e)-1;return this.getXInitPlaceholder(t)}storeTemplatingString(e){let t=this.templatingStrings.push(e)-1;return this.getTemplatingStringPlaceholder(t)}storeStringLiteralInPhp(e){let t=this.stringLiteralInPhp.push(e)-1;return this.getStringLiteralInPhpPlaceholder(t)}getIgnoredLinePlaceholder(e){return i.default.replace("___ignored_line_#___","#",e)}getCurlyBraceForJSPlaceholder(e){return i.default.replace("___js_curly_brace_#___","#",e)}getRawPlaceholder(e){return i.default.replace("@__raw_block_#__@","#",e)}getInlinePlaceholder(e,t=0){if(t>0){let r=t-"___inline_directive_#___".length;return i.default.replace(`___inline_directive_${i.default.repeat("_",r>0?r:0)}#___`,"#",e)}return i.default.replace("___inline_directive_+?#___","#",e)}getConditionPlaceholder(e){return i.default.replace("___directive_condition_#___","#",e)}getInlinePhpPlaceholder(e){return i.default.replace("___inline_php_directive_#___","#",e)}getRawPropsPlaceholder(e){return i.default.replace("@__raw_props_block_#__@","#",e)}getBladeDirectivePlaceholder(e){return i.default.replace("___blade_directive_#___","#",e)}getBladeCommentPlaceholder(e){return i.default.replace("___blade_comment_#___","#",e)}getBladeBracePlaceholder(e,t=0){if(t>0){let r=t-"___blade_brace_#___".length;return i.default.replace(`___blade_brace_${i.default.repeat("_",r>0?r:0)}#___`,"#",e)}return i.default.replace("___blade_brace_+?#___","#",e)}getRawBladeBracePlaceholder(e){return i.default.replace("___raw_blade_brace_#___","#",e)}getRawPhpTagPlaceholder(e){return i.default.replace("___raw_php_tag_#___","#",e)}getScriptPlaceholder(e){return i.default.replace("<blade ___scripts_#___ />","#",e)}getHtmlTagPlaceholder(e){return i.default.replace("<blade ___html_tags_#___ />","#",e)}getClassPlaceholder(e,t){if(t&&t>0){let r=t-"___class_#___".length;return i.default.replace(`___class${i.default.repeat("_",r>0?r:1)}#___`,"#",e)}return i.default.isNull(t)?i.default.replace("___class_#___","#",e):i.default.replace("___class_+?#___","#",e)}getShorthandBindingPlaceholder(e,t=0){if(t&&t>0){let r=t-"___short_binding_#___".length;return i.default.replace(`___short_binding_${i.default.repeat("_",r>0?r:1)}#___`,"#",e)}return i.default.replace("___short_binding_+?#___","#",e)}getComponentAttributePlaceholder(e){return i.default.replace("___attribute_#___","#",e)}getXInitPlaceholder(e){return i.default.replace("___x_init_#___","#",e)}getPlaceholder(e,t,n=null){if(n&&n>0){let r=`___${e}_#___`,s=n-r.length;return i.default.replace(`___${e}${i.default.repeat("_",s>0?s:1)}#___`,"#",t)}return i.default.isNull(n)?i.default.replace(`___${e}_#___`,"#",t):i.default.replace(`s___${e}_+?#___`,"#",t)}getXDataPlaceholder(e){return i.default.replace("___x_data_#___","#",e)}getTemplatingStringPlaceholder(e){return i.default.replace("___templating_str_#___","#",e)}getStringLiteralInPhpPlaceholder(e){return i.default.replace("'___php_content_#___'","#",e)}restoreIgnoredLines(e){return i.default.replace(e,new RegExp(`${this.getIgnoredLinePlaceholder("(\\d+)")}`,"gm"),(t,n)=>this.ignoredLines[n])}restoreCurlyBraceForJS(e){return i.default.replace(e,new RegExp(`${this.getCurlyBraceForJSPlaceholder("(\\d+)")}`,"gm"),(t,n)=>`@{{ ${x.default.js_beautify(this.curlyBracesWithJSs[n].trim())} }}`)}restorePhpBlock(e){return this.restoreRawPhpBlock(e).then(t=>this.restoreRawPropsBlock(t))}async restoreRawPhpBlock(e){return i.default.replace(e,new RegExp(`^(.*?)${this.getRawPlaceholder("(\\d+)")}`,"gm"),(t,n,r)=>{let s=this.rawBlocks[r];return this.isInline(s)&&this.isMultilineStatement(s)?s=S(`<?php
${s}
?>`).trim():s.split(`
`).length>1?s=S(`<?php${s}?>`).trimRight(`
`):s=`<?php${s}?>`,i.default.replace(s,/^(\s*)?<\?php(.*?)\?>/gms,(a,l,h)=>{if(this.isInline(s))return`${n}@php${h}@endphp`;let c=this.preserveStringLiteralInPhp(h),m=this.indentRawBlock(n,c),p=this.restoreStringLiteralInPhp(m);return`${i.default.isEmpty(n)?"":n}@php${p}@endphp`})})}async restoreRawPropsBlock(e){let t=this.getRawPropsPlaceholder("(\\d+)");return i.default.replace(e,new RegExp(t,"gms"),(n,r)=>`@props(${P(this.rawPropsBlocks[r]).trimRight()})`)}isInline(e){return i.default.split(e,`
`).length===1}isMultilineStatement(e){return S(`<?php${e}?>`).trimRight().split(`
`).length>1}indentRawBlock(e,t){if(i.default.isEmpty(e))return t;if(this.isInline(t))return`${e}${t}`;let r=(0,B.default)(e).amount/this.indentSize,s=this.indentCharacter.repeat(r<0?0:(r+1)*this.indentSize),a=this.indentCharacter.repeat(r<0?0:r*this.indentSize),l=t.split(`
`);return i.default.chain(l).map((h,c)=>c===0?h.trim():c===l.length-1?a+h:s+h).join(`
`)}indentBladeDirectiveBlock(e,t){if(i.default.isEmpty(e))return t;if(this.isInline(t))return`${e}${t}`;let r=(0,B.default)(e).amount/this.indentSize,s=this.indentCharacter.repeat(r<0?0:r*this.indentSize),a=this.indentCharacter.repeat(r<0?0:r*this.indentSize),l=t.split(`
`);return i.default.chain(l).map((h,c)=>c===l.length-1?a+h:s+h).value().join(`
`)}indentScriptBlock(e,t){if(i.default.isEmpty(e))return t;if(this.isInline(t))return`${e}${t}`;let r=(0,B.default)(e).amount/this.indentSize,s=this.indentCharacter.repeat(r<0?0:r*this.indentSize),a=this.indentCharacter.repeat(r<0?0:r*this.indentSize),h=i.default.replace(t,/`.*?`/gs,m=>this.storeTemplatingString(m)).split(`
`),c=i.default.chain(h).map((m,p)=>p===0?m:p===h.length-1?a+m:i.default.isEmpty(m)?m:s+m).value().join(`
`);return this.restoreTemplatingString(`${e}${c}`)}indentRawPhpBlock(e,t){if(i.default.isEmpty(e))return t;if(this.isInline(t)&&/\s/.test(e))return`${e}${t}`;if(this.isInline(t)&&/\S/.test(e))return`${t}`;let r=(0,B.default)(e).amount/this.indentSize,s=this.indentCharacter.repeat(r<0?0:r*this.indentSize),a=t.split(`
`);return i.default.chain(a).map((l,h)=>h===0?l.trim():s+l).value().join(`
`)}indentComponentAttribute(e,t){if(i.default.isEmpty(e))return t;if(this.isInline(t))return`${t}`;if(this.isInline(t)&&/\S/.test(e))return`${t}`;let r=(0,B.default)(e).amount/this.indentSize,s=this.indentCharacter.repeat(r<0?0:r*this.indentSize),a=t.split(`
`);return i.default.chain(a).map((l,h)=>h===0?l.trim():s+l).value().join(`
`)}restoreBladeDirectivesInScripts(e){let t=new RegExp(`^(.*?)${this.getBladeDirectivePlaceholder("(\\d+)")}`,"gm"),n=i.default.replace(e,t,(r,s,a)=>this.indentBladeDirectiveBlock(s,this.bladeDirectives[a]));return t.test(e)&&(n=this.restoreBladeDirectivesInScripts(n)),n}async formatPreservedBladeDirectives(e){return we.default.map(e,async t=>{let n=await this.formatAsHtml(t);return(await this.formatAsBlade(n)).trimRight(`
`)})}restoreBladeComment(e){return new Promise(t=>t(e)).then(t=>i.default.replace(t,new RegExp(`${this.getBladeCommentPlaceholder("(\\d+)")}`,"gms"),(n,r)=>`{{-- ${this.bladeComments[r].trim()} --}}`))}restoreBladeBrace(e){return new Promise(t=>t(e)).then(t=>i.default.replace(t,new RegExp(`(.*?)${this.getBladeBracePlaceholder("(\\d+)")}`,"gm"),(n,r,s)=>{let a=this.bladeBraces[s];return a.trim()===""?`${r}{{${a}}}`:this.isInline(a)?`${r}{{ ${P(a,120,!1).replace(/([\n\s]*)->([\n\s]*)/gs,"->").split(`
`).map(l=>l.trim()).join("").trimRight(`
`)} }}`:`${r}{{ ${this.indentRawPhpBlock(r,P(a,120,!0).replace(/([\n\s]*)->([\n\s]*)/gs,"->").trim().trimRight(`
`))} }}`}))}restoreRawBladeBrace(e){return new Promise(t=>t(e)).then(t=>i.default.replace(t,new RegExp(`${this.getRawBladeBracePlaceholder("(\\d+)")}`,"gms"),(n,r)=>{let s=this.rawBladeBraces[r];return s.trim()===""?`{!!${s}!!}`:`{!! ${P(s).replace(/([\n\s]*)->([\n\s]*)/gs,"->").trim().trimRight(`
`)} !!}`}))}restoreInlineDirective(e){return new Promise(t=>t(e)).then(t=>i.default.replace(t,new RegExp(`${this.getInlinePlaceholder("(\\d+)")}`,"gms"),(n,r)=>this.inlineDirectives[r]))}restoreConditions(e){return new Promise(t=>t(e)).then(t=>i.default.replace(t,new RegExp(`${this.getConditionPlaceholder("(\\d+)")}`,"gms"),(n,r)=>{let s=this.conditions[r];return P(s).replace(/([\n\s]*)->([\n\s]*)/gs,"->").trimEnd()}))}restoreInlinePhpDirective(e){return new Promise(t=>t(e)).then(t=>i.default.replace(t,new RegExp(`(.*?)${this.getInlinePhpPlaceholder("(\\d+)")}`,"gm"),(n,r,s)=>{let a=this.inlinePhpDirectives[s];return a.includes("@php")?`${r}${P(a).replace(/([\n\s]*)->([\n\s]*)/gs,"->").trim().trimRight(`
`)}`:/(@button|@class|@include)/gi.test(a)?i.default.replace(a,/@(button|class|include)(.*)/gis,(h,c,m)=>{var y;let p;if(["button","class"].includes(c)&&(p=80),c==="include"){let C=a.match(/@include\s*?\(\s*?['"](.*?)['"]\s*?/i),T=(y=i.default.nth(C,1))!=null?y:"";p=this.wrapLineLength+`func_inline_for_${c}`.length-r.length-T.length}let g=P(`func_inline_for_${c}${m}`,p,!0).replace(/([\n\s]*)->([\n\s]*)/gs,"->").replace(/,(\s*?\))/gis,(C,T)=>T).trim().trimRight(`
`);return this.isInline(g)?`${this.indentRawPhpBlock(r,`@${g}`.replace("func_inline_for_",""))}`:`${r}${this.indentRawPhpBlock(r,`@${g}`.replace("func_inline_for_",""))}`}):`${r}${P(a).trimEnd()}`}))}restoreRawPhpTags(e){return new Promise(t=>t(e)).then(t=>i.default.replace(t,new RegExp(`${this.getRawPhpTagPlaceholder("(\\d+)")}`,"gms"),(n,r)=>{try{let s=this.rawPhpTags[r];if(/(?<=<\?php\s*?)\/\*.*?\*\/(?=\s*?\?>)/gim.test(s)&&this.isInline(s))return s;let h=S(this.rawPhpTags[r]).trim().trimRight(`
`);if(this.isInline(h))return h;let c=t.match(new RegExp(`^(\\s*?)[^\\s]*?${this.getRawPhpTagPlaceholder(r)}`,"ms"));return c?this.indentRawPhpBlock(c[1],h):h}catch{return`${this.rawPhpTags[r]}`}}))}restoreScripts(e){return new Promise(t=>t(e)).then(t=>i.default.replace(t,new RegExp(`^(.*?)${this.getScriptPlaceholder("(\\d+)")}`,"gim"),(n,r,s)=>{let a=this.scripts[s],l={indent_size:_(this.options).indentSize||4,wrap_line_length:_(this.options).wrapLineLength||120,wrap_attributes:_(this.options).wrapAttributes||"auto",wrap_attributes_indent_size:r.length,end_with_newline:!1,templating:["php"]};return this.indentScriptBlock(r,x.default.html_beautify(a,l))}))}async restoreHtmlTags(e){return i.default.replace(e,new RegExp(`(.*?)${this.getHtmlTagPlaceholder("(\\d+)")}`,"gim"),(t,n,r)=>{let s={indent_size:_(this.options).indentSize||4,wrap_line_length:_(this.options).wrapLineLength||120,wrap_attributes:_(this.options).wrapAttributes||"auto",wrap_attributes_indent_size:n.length+(_(this.options).indentSize||4)*1,end_with_newline:!1,templating:["php"]};return`${n}${x.default.html_beautify(this.htmlTags[r],s)}`})}restoreClass(e){return i.default.replace(e,new RegExp(`${this.getClassPlaceholder("(\\d+)")}`,"gms"),(t,n)=>this.classes[n])}restoreXData(e){return i.default.replace(e,new RegExp(`^(.*?)${this.getXDataPlaceholder("(\\d+)")}`,"gm"),(t,n,r)=>{var g;let s=n.split(`
`).pop(),[,a]=(g=/(\s*)[^\s]+/g.exec(s))!=null?g:[],l=this.formatJS(this.xData[r]).split(`
`),h=a.length/(this.indentCharacter==="	"?4:1),c=l[0],m=this.indentCharacter.repeat(h<0?0:h),p=l.map(y=>m+y);return p[0]=c,`${n}${p.join(`
`)}`})}restoreXInit(e){return i.default.replace(e,new RegExp(`^(.*?)${this.getXInitPlaceholder("(\\d+)")}`,"gm"),(t,n,r)=>{var g;let s=n.split(`
`).pop(),[,a]=(g=/(\s*)[^\s]+/g.exec(s))!=null?g:[],l=this.formatJS(this.xInit[r]).split(`
`),h=a.length/(this.indentCharacter==="	"?4:1),c=l[0],m=this.indentCharacter.repeat(h<0?0:h),p=l.map(y=>m+y);return p[0]=c,`${n}${p.join(`
`)}`})}restoreTemplatingString(e){return i.default.replace(e,new RegExp(`${this.getTemplatingStringPlaceholder("(\\d+)")}`,"gms"),(t,n)=>this.templatingStrings[n])}restoreStringLiteralInPhp(e){return i.default.replace(e,new RegExp(`${this.getStringLiteralInPhpPlaceholder("(\\d+)")}`,"gms"),(t,n)=>this.stringLiteralInPhp[n])}restoreComponentAttribute(e){return i.default.replace(e,new RegExp(`${this.getComponentAttributePlaceholder("(\\d+)")}`,"gim"),(t,n)=>{var c;let r=this.getComponentAttributePlaceholder(n),s=(c=e.match(new RegExp(`^(.*?)${r}`,"gmi")))!=null?c:[""],a=(0,B.default)(s[0]),l=this.componentAttributes[n],h=i.default.replace(l,/(:{1,2}.*?=)(["'])(.*?)(?=\2)/gis,(m,p,g,y)=>{if(y==="")return m;if(p.startsWith("::"))return`${p}${g}${x.default.js_beautify(y,{wrap_line_length:this.wrapLineLength-a.amount,brace_style:"preserve-inline"}).trim()}`;if(this.isInline(y))try{return`${p}${g}${P(y,this.wrapLineLength-a.amount).trimEnd()}`}catch{return`${p}${g}${y}`}return`${p}${g}${P(y,this.wrapLineLength-a.amount).trimEnd()}`});return`${this.indentComponentAttribute(a.indent,h)}`})}restoreShorthandBinding(e){return i.default.replace(e,new RegExp(`${this.getShorthandBindingPlaceholder("(\\d+)")}`,"gms"),(t,n)=>{var c;let r=this.getShorthandBindingPlaceholder(n),s=(c=e.match(new RegExp(`^(.*?)${r}`,"gmi")))!=null?c:[""],a=(0,B.default)(s[0]),l=this.shorthandBindings[n],h=i.default.replace(l,/(:{1,2}.*?=)(["'])(.*?)(?=\2)/gis,(m,p,g,y)=>{let C={wrap_line_length:this.wrapLineLength-a.amount,brace_style:"preserve-inline"};if(y==="")return m;if(this.isInline(y))try{return`${p}${g}${x.default.js_beautify(y,C).trimEnd()}`}catch{return`${p}${g}${y}`}return`${p}${g}${x.default.js_beautify(y,C).trimEnd()}`});return`${this.indentComponentAttribute(a.indent,h)}`})}async formatAsBlade(e){let t=E(e),n=await new G(this.vsctm,this.oniguruma);return n.createRegistry(e).loadGrammar("text.html.php.blade").then(a=>n.tokenizeLines(t,a)).then(a=>this.formatTokenizedLines(t,a)).catch(a=>{throw a})}formatTokenizedLines(e,t){this.result=[],this.stack=[];for(let n=0;n<e.length;n+=1){let r=e[n],s=t[n];this.processLine(s,r)}return this.result.join(_e.default.EOL)}processLine(e,t){this.processTokenizeResult(e,t)}processKeyword(e){if(i.default.includes(z,e)){i.default.last(this.stack)==="@case"&&e==="@case"&&this.decrementIndentLevel(),e==="@case"&&(this.shouldBeIndent=!0),this.stack.push(e);return}if(i.default.includes(O,e)){if(e==="@break"){this.decrementIndentLevel(),this.stack.pop(),this.stack.push(e);return}if(i.default.last(this.stack)!=="@hassection"){this.stack.pop();return}}if(i.default.includes(re,e)&&(this.shouldBeIndent=!0,this.stack.push(e)),i.default.includes(ne,e)&&i.default.includes(te,i.default.last(this.stack))&&(this.decrementIndentLevel(),this.shouldBeIndent=!0),i.default.includes(v,e)&&(i.default.last(this.stack)==="@section"&&e==="@section"?(this.currentIndentLevel>0&&this.decrementIndentLevel(),this.shouldBeIndent=!0,this.stack.push(e)):(this.shouldBeIndent=!0,this.stack.push(e))),i.default.includes(D,e)){if(e==="@endswitch"&&i.default.last(this.stack)==="@default"){this.decrementIndentLevel(2),this.shouldBeIndent=!1;return}this.decrementIndentLevel(),this.shouldBeIndent=!1,this.stack.pop()}i.default.includes(j,e)&&(this.decrementIndentLevel(),this.shouldBeIndent=!0)}processToken(e,t){if(i.default.includes(e.scopes,"punctuation.definition.comment.begin.blade")&&(this.isInsideCommentBlock=!0),this.argumentCheck){let{count:n,inString:r,stack:s}=this.argumentCheck;if(!r&&t===")"){if(s.push(t),n[t]+=1,n["("]===n[t]){let a=s.join("");oe(a)>=this.argumentCheck.unindentOn&&(this.shouldBeIndent=!1),this.argumentCheck=!1}return}s.push(t),r===t?this.argumentCheck.inString=!1:!r&&(t==='"'||t==="'")&&(this.argumentCheck.inString=t),t==="("&&!r&&(n[t]+=1)}i.default.includes(e.scopes,"punctuation.definition.comment.end.blade")&&(this.isInsideCommentBlock=!1),(t==="{{--"||t.includes("{{--"))&&(this.isInsideCommentBlock=!0),(t==="--}}"||t.includes("--}}"))&&(this.isInsideCommentBlock=!1),!!i.default.includes(e.scopes,"keyword.blade")&&(this.isInsideCommentBlock||(this.processKeyword(t.toLowerCase()),i.default.includes(Object.keys(V),t.toLowerCase())&&(this.argumentCheck={unindentOn:V[t.toLowerCase()],stack:[],inString:!1,count:{"(":0,")":0}})))}processTokenizeResult(e,t){if(this.shouldBeIndent&&(this.incrementIndentLevel(),this.shouldBeIndent=!1),se(e,t)){this.insertFormattedLineToResult(t);return}for(let n=0;n<e.tokens.length;n+=1){let r=e.tokens[n],s=t.substring(r.startIndex,r.endIndex).trim();this.processToken(r,s)}this.insertFormattedLineToResult(t)}insertFormattedLineToResult(e){let n=(0,B.default)(e).amount+this.indentSize*this.currentIndentLevel,r=this.indentCharacter.repeat(n<0?0:n)+e.trim();e.length===0&&this.result.push(e),e.length!==0&&r.length>0&&this.result.push(r),r!==e&&this.diffs.push({original:e,formatted:r})}incrementIndentLevel(e=1){this.currentIndentLevel+=e}decrementIndentLevel(e=1){this.currentIndentLevel-=e}formatJS(e){let t=e,n={js:[],entangle:[]};return Object.keys(n).forEach(r=>{t=t.replace(new RegExp(`@${r}\\((?:[^)(]+|\\((?:[^)(]+|\\([^)(]*\\))*\\))*\\)`,"gs"),s=>{let a=n[r].push(s)-1;return this.getPlaceholder(r,a,s.length)})}),t=x.default.js_beautify(t,{brace_style:"preserve-inline"}),Object.keys(n).forEach(r=>{t=t.replace(new RegExp(this.getPlaceholder(r,"_*(\\d+)"),"gms"),(s,a)=>n[r][a])}),t}};var Pe=d(require("path")),ve=d(require("fs")),be=d(require("ajv")),xe=d(require("find-config")),Ge=new be.default,Be=[".bladeformatterrc.json",".bladeformatterrc"];function Se(o){for(let e=0;e<Be.length;e+=1){let t=(0,xe.default)(Be[e],{cwd:Pe.default.dirname(o),home:!1});if(t)return t}return null}async function Ce(o){if(o===null)return;let e=JSON.parse((await ve.default.promises.readFile(o)).toString()),t={type:"object",properties:{indentSize:{type:"integer",nullable:!0},wrapLineLength:{type:"integer",nullable:!0},wrapAttributes:{type:"string",enum:["auto","force","force-aligned","force-expand-multiline","aligned-multiple","preserve","preserve-aligned"],nullable:!0},endWithNewline:{type:"boolean",nullable:!0},useTabs:{type:"boolean",nullable:!0}},additionalProperties:!0},n=Ge.compile(t);if(!n(e))throw n;return e}var K=class extends Error{};var R=class{constructor(e={},t=[]){this.currentTargetPath=".",this.paths=t,this.options=e,this.targetFiles=[],this.errors=[],this.diffs=[],this.outputs=[],this.formattedFiles=[],this.ignoreFile="",this.fulFillFiles=[],this.targetFiles=[],this.runtimeConfigCache={}}async format(e,t={}){let n=this.options||t;return await this.readIgnoreFile(u.default.cwd()),await this.readRuntimeConfig(u.default.cwd()),new F(n).formatContent(e).catch(r=>{throw new K(r)})}async formatFromCLI(){try{this.printPreamble(),await this.readIgnoreFile(u.default.cwd()),await this.processPaths(),this.printResults()}catch{}}fileExists(e){return I.default.promises.access(e,I.default.constants.F_OK).then(()=>!0).catch(()=>!1)}async readIgnoreFile(e){let t=".bladeignore",n,r=k.default.dirname(e);if(this.options.ignoreFilePath?n=this.options.ignoreFilePath:n=(0,Le.default)(t,{cwd:r}),!!n)try{this.ignoreFile=(await I.default.promises.readFile(n)).toString()}catch{}}async readRuntimeConfig(e){var n,r;f.default.isEmpty(this.runtimeConfigCache)&&(this.options=f.default.merge(this.options,this.runtimeConfigCache));let t;if(this.options.runtimeConfigPath?t=this.options.runtimeConfigPath:t=Se(e),!f.default.isNull(t))try{let s=await Ce(t);this.options=f.default.merge(this.options,s),this.runtimeConfigCache=this.options}catch(s){s instanceof SyntaxError&&(u.default.stdout.write(w.default.red.bold(`
Blade Formatter JSON Syntax Error: 

`)),u.default.stdout.write(Q.default.format(s)),u.default.exit(1)),u.default.stdout.write(w.default.red.bold(`
Blade Formatter Config Error: ${k.default.basename(t)}

`)),u.default.stdout.write(`\`${s.errors[0].instancePath.replace("/","")}\` ${s.errors[0].message}

`),((n=s.errors[0].params)==null?void 0:n.allowedValues)&&console.log((r=s.errors[0].params)==null?void 0:r.allowedValues),u.default.exit(1)}}async processPaths(){await Promise.all(f.default.map(this.paths,async e=>this.processPath(e)))}async processPath(e){await R.globFiles(e).then(t=>f.default.map(t,n=>k.default.relative(".",n))).then(t=>this.filterFiles(t)).then(this.fulFillFiles).then(t=>this.formatFiles(t))}static globFiles(e){return new Promise((t,n)=>{(0,Re.default)(e,(r,s)=>r?n(r):t(s))})}async filterFiles(e){if(this.ignoreFile==="")return e;let t=/^\.\.*/,n=f.default.filter(e,a=>t.test(k.default.relative(".",a))),r=f.default.xor(e,n),s=(0,Ie.default)().add(this.ignoreFile).filter(r);return f.default.concat(n,s)}static fulFillFiles(e){return this.targetFiles.push(e),Promise.resolve(e)}async formatFiles(e){await Promise.all(f.default.map(e,async t=>this.formatFile(t)))}async formatFile(e){await this.readRuntimeConfig(e),await H(e).then(t=>Promise.resolve(t.toString("utf-8"))).then(t=>new F(this.options).formatContent(t)).then(t=>this.checkFormatted(e,t)).then(t=>this.writeToFile(e,t)).catch(t=>{this.handleError(e,t)})}async checkFormatted(e,t){this.printFormattedOutput(e,t);let n=I.default.readFileSync(e,"utf-8"),r=E(n),s=E(t),a=he(e,r,s);return this.diffs.push(a),this.outputs.push(t),a.length>0&&((this.options.progress||this.options.write)&&u.default.stdout.write(w.default.green("F")),this.options.checkFormatted&&(u.default.stdout.write(`${e}
`),u.default.exitCode=1),this.formattedFiles.push(e)),a.length===0&&(this.options.progress||this.options.write)&&u.default.stdout.write(w.default.green(".")),Promise.resolve(t)}printFormattedOutput(e,t){this.options.write||this.options.checkFormatted||(u.default.stdout.write(`${t}`),f.default.last(this.paths)===e||f.default.last(this.targetFiles)===e)||(this.paths.length>1||this.targetFiles.length>1)&&u.default.stdout.write(`
`)}writeToFile(e,t){!this.options.write||this.options.checkFormatted||t.length===0||f.default.isNull(t)||f.default.isEmpty(t)||I.default.writeFile(e,t,n=>{n&&(u.default.stdout.write(`${w.default.red(n.message)}
`),u.default.exit(1))})}handleError(e,t){(this.options.progress||this.options.write)&&u.default.stdout.write(w.default.red("E")),u.default.exitCode=1,this.errors.push({path:e,message:t.message,error:t})}printPreamble(){this.options.checkFormatted&&u.default.stdout.write(`Check formatting... 
`)}async printResults(){this.printDescription(),this.printDifferences(),this.printFormattedFiles(),this.printErrors()}printDescription(){if(!this.options.write)return;let e=`

`;u.default.stdout.write(e),u.default.stdout.write(w.default.bold.green(`Fixed: F
`)),u.default.stdout.write(w.default.bold.red(`Errors: E
`)),u.default.stdout.write(w.default.bold("Not Changed: ")+w.default.bold.green(`.
`))}printFormattedFiles(){if(this.formattedFiles.length===0){this.options.checkFormatted&&u.default.stdout.write(w.default.bold(`
All matched files are formatted! 
`));return}if(!this.options.write){this.options.checkFormatted&&u.default.stdout.write(`
Above file(s) are formattable. Forgot to run formatter? Use ${w.default.bold("--write")} option to overwrite.
`);return}u.default.stdout.write(w.default.bold(`
Formatted Files: 
`)),f.default.each(this.formattedFiles,e=>u.default.stdout.write(`${w.default.bold(e)}
`))}printDifferences(){if(!!this.options.diff){if(u.default.stdout.write(w.default.bold(`
Differences: 

`)),f.default.filter(this.diffs,e=>e.length>0).length===0){u.default.stdout.write((0,w.default)(`No changes found. 

`));return}f.default.each(this.diffs,e=>le(e))}}printErrors(){f.default.isEmpty(this.errors)||(u.default.stdout.write(w.default.red.bold(`
Errors: 

`)),f.default.each(this.errors,e=>u.default.stdout.write(`${Q.default.format(e)}
`)))}};async function De(){let o=await(0,Ee.default)((0,Ae.hideBin)(process.argv)).usage("Usage: $0 [options] [file glob | ...]").example('$0 "resources/views/**/*.blade.php" --write',"Format all files in views directory").option("check-formatted",{alias:"c",type:"boolean",description:"Only checks files are formatted or not",default:!1}).option("write",{alias:"w",type:"boolean",description:"Write to file",default:!1}).option("diff",{alias:"d",type:"boolean",description:"Show diffs",default:!1}).option("end-with-newline",{alias:"e",type:"boolean",description:"End output with newline",default:!0}).option("indent-size",{alias:"i",type:"integer",description:"Indentation size",default:4}).option("wrap-line-length",{alias:"wrap",type:"integer",description:"The length of line wrap size",default:120}).option("wrap-attributes",{alias:"wrap-atts",type:"string",description:"The way to wrap attributes",default:"auto"}).option("sort-tailwindcss-classes",{alias:"sort-classes",type:"boolean",description:"Sort tailwindcss classes",default:!1}).option("progress",{alias:"p",type:"boolean",description:"Print progress",default:!1}).option("stdin",{type:"boolean",description:"format code provided on <STDIN>",default:!1}).option("config",{alias:["runtimeConfigPath"],type:"string",description:"Use this configuration, overriding .bladeformatterrc config options if present",default:null}).option("ignore-path",{alias:["ignoreFilePath"],type:"string",description:"Specify path of ignore file",default:null}).help("h").alias("h","help").epilog("Copyright Shuhei Hayashibara 2019"),e=await Te.promises.readFile(require.resolve("vscode-oniguruma/release/onig.wasm"));if(await(0,ke.loadWASM)(e.buffer),o.argv.stdin){await process.stdin.pipe((0,Fe.default)({encoding:"string"},n=>new R(o.argv).format(n).then(r=>{r!==void 0&&process.stdout.write(r)}).catch(r=>{process.stdout.write(`${r.toString()}
`),process.exit(1)})));return}if(o.argv._.length===0){o.showHelp();return}await new R(o.argv,o.argv._).formatFromCLI()}module.exports=Xe(qe);0&&(module.exports={});
//# sourceMappingURL=cli-bundle.js.map
